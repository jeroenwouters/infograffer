var mongo=require("mongodb"),Server=mongo.Server,Db=mongo.Db,BSON=mongo.BSONPure,server=new Server("localhost",27017,{auto_reconnect:!0});db=new Db("mapdb",server);db.open(function(e,t){if(!e){console.log("Connected to 'mapdb' database");t.collection("map",{safe:!0},function(e,t){if(e){console.log("The 'items' collection doesn't exist. d");populateDB()}})}});exports.findAllMaps=function(e,t){db.collection("map",function(e,n){n.find().toArray(function(e,n){t.send(n)})})};exports.addmap=function(e,t){var n=e.body;console.log("Adding map: "+JSON.stringify(n));db.collection("map",function(e,r){r.insert(n,{safe:!0},function(e,n){if(e)t.send({error:"An error has occurred"});else{console.log("Success: "+JSON.stringify(n[0]));t.send(n[0])}})})};